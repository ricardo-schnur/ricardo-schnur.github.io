<!doctype html>
<html lang="de" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Hexagonale Architektur in der Praxis: Umsetzung in einem Java/Spring Boot Projekt – Teil 3: REST-Schnittstelle mit Antikorruptionsschicht | Ricardo&#x27;s Dev Blog</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ricardo-schnur.github.io/hexagonal-architecture-java-spring-boot-part-3"><meta data-rh="true" property="og:locale" content="de"><meta data-rh="true" name="docusaurus_locale" content="de"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="de"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Hexagonale Architektur in der Praxis: Umsetzung in einem Java/Spring Boot Projekt – Teil 3: REST-Schnittstelle mit Antikorruptionsschicht | Ricardo&#x27;s Dev Blog"><meta data-rh="true" name="description" content="banner"><meta data-rh="true" property="og:description" content="banner"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-01-08T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/ricardo-schnur"><meta data-rh="true" property="article:tag" content="Domain-driven Design,Hexagonale Architektur,Softwarearchitektur,Softwareentwicklung"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="alternate" href="https://ricardo-schnur.github.io/hexagonal-architecture-java-spring-boot-part-3" hreflang="de"><link data-rh="true" rel="alternate" href="https://ricardo-schnur.github.io/hexagonal-architecture-java-spring-boot-part-3" hreflang="x-default"><link data-rh="true" rel="canonical" href="https://www.colenet.de/blog/development/hexagonale-architektur-in-der-praxis-teil-3-rest-schnittstelle-mit-antikorruptionsschicht/"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Ricardo&#39;s Dev Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Ricardo&#39;s Dev Blog Atom Feed"><link rel="stylesheet" href="/assets/css/styles.c2a98a3b.css">
<script src="/assets/js/runtime~main.d44eed94.js" defer="defer"></script>
<script src="/assets/js/main.ca346ef3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Zum Hauptinhalt springen"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Zum Hauptinhalt springen</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/profile.png" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/profile.png" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Ricardo&#x27;s Dev Blog</b></a></div><div class="navbar__items navbar__items--right"><a href="https://www.linkedin.com/in/ricardo-schnur" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/ricardo-schnur" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Umschalten zwischen dunkler und heller Ansicht (momentan heller Modus)" aria-label="Umschalten zwischen dunkler und heller Ansicht (momentan heller Modus)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Navigation der letzten Beiträge im Blog"><div class="sidebarItemTitle_pO2u margin-bottom--md">Neueste Beiträge</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hexagonal-architecture-java-spring-boot-part-5">Hexagonale Architektur in der Praxis: Umsetzung in einem Java/Spring-Boot-Projekt – Teil 5: Anbindung der Datenbank (am Beispiel einer MongoDB)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hexagonal-architecture-java-spring-boot-part-4">Hexagonale Architektur in der Praxis: Umsetzung in einem Java/Spring Boot Projekt – Teil 4: Folgen einer Änderung am Domänenmodell und die Applikationsschicht</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/hexagonal-architecture-java-spring-boot-part-3">Hexagonale Architektur in der Praxis: Umsetzung in einem Java/Spring Boot Projekt – Teil 3: REST-Schnittstelle mit Antikorruptionsschicht</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hexagonal-architecture-java-spring-boot-part-2">Hexagonale Architektur in der Praxis: Umsetzung in einem Java/Spring-Boot-Projekt – Teil 2: Modellierung, Kernlogik und In-Memory Cache</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/hexagonal-architecture-java-spring-boot-part-1">Hexagonale Architektur in der Praxis: Umsetzung in einem Java/Spring-Boot-Projekt – Teil 1: Projektbeschreibung, Setup und automatische Architekturtests</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="banner"><header><h1 class="title_f1Hy" itemprop="headline">Hexagonale Architektur in der Praxis: Umsetzung in einem Java/Spring Boot Projekt – Teil 3: REST-Schnittstelle mit Antikorruptionsschicht</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-01-08T00:00:00.000Z" itemprop="datePublished">8. Januar 2024</time> · <!-- -->11 Minuten Lesezeit</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/ricardo-schnur" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="img/profile.png" alt="Ricardo Schnur" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/ricardo-schnur" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Ricardo Schnur</span></a></div><small class="avatar__subtitle" itemprop="description">Software Developer @ Colenet GmbH</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p><img decoding="async" loading="lazy" alt="banner" src="/assets/images/banner-3c6221cdc4cb306e621cac5c416145fb.webp" width="1028" height="611" class="img_ev3q"></p>
<blockquote>
<p>Um zu verstehen, wie hexagonale Architektur die Art und Weise, Software zu entwickeln, verändert und was dabei
die Vorteile sind, führt Ricardo uns Schritt für Schritt durch die Entwicklung einer To-Do-Listen-Anwendung.
Im 3. Teil wird nun über eine REST-Schnittstelle die Anwendung interaktiv nutzbar gemacht und die Datenintegrität
durch eine Antikorruptionsschicht sichergestellt.</p>
</blockquote>
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<p>Diese Artikel-Reihe ist der hexagonalen Architektur gewidmet: Wir möchten ihre Grundprinzipien verstehen und diese in
der Praxis erleben. Wir werden uns anschauen, wie sich eine hexagonale Architektur in einer typischen Webanwendung
praktisch realisieren lässt. Dazu werden wir Schritt für Schritt eine kleine <strong>To-do-Listen-Anwendung</strong> entwickeln, die
es
ermöglichen soll, Tasks anzulegen, angelegte Tasks anzuzeigen und Tasks als erledigt zu markieren. Die Anwendung wird
über eine REST-Schnittstelle bedienbar sein und die Tasks werden konfigurierbar entweder In-Memory oder persistent in
einer echten MongoDB verwaltet.</p>
<p><a href="https://ricardo-schnur.github.io/hexagonal-architecture-java-spring-boot-part-1" target="_blank" rel="noopener noreferrer">Im ersten Teil</a> dieser Serie haben wir
ein frisches Java/Spring-Boot-Projekt aufgesetzt und konfiguriert. Wir haben uns
überlegt, wie wir uns die Architektur der Anwendung und ihre Umsetzung vorstellen und diese Vorstellung mittels ArchUnit
in einem automatisierten Architekturtest festgehalten.</p>
<p><a href="https://ricardo-schnur.github.io/hexagonal-architecture-java-spring-boot-part-2" target="_blank" rel="noopener noreferrer">Im zweiten Teil</a> sind wir mit der
Modellierung der Domäne, der Implementierung der Kernlogik und der Datenhaltung der
Anwendung in die eigentliche Entwicklung gestartet.</p>
<p>Nun möchten wir unsere Anwendung auch interaktiv nutzbar machen und zu diesem Zweck eine REST-Schnittstelle
bereitstellen.
Genauer möchten wir</p>
<ul>
<li>einen <code>GET</code>-Endpunkt <code>/task</code>, der uns alle existierenden Tasks zurückliefert,</li>
<li>einen <code>POST</code>-Endpunkt <code>/task</code>, der es uns erlaubt, einen neuen Task anzulegen und den angelegten Task zurückliefert,
sowie</li>
<li>einen <code>POST</code>-Endpunkt <code>/task/toggle-completion/{id}</code>, der es uns erlaubt, den Zustand eines existierenden
Tasks umzuschalten und den umgeschalteten Task zurückliefert.</li>
</ul>
<p>Hierbei soll der <code>POST</code>-Endpunkt <code>/task</code> mit einem Parameter <code>description</code> aufgerufen werden können.
Mögliche Requests sehen dann etwa folgendermaßen aus:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">GET http://localhost:8080/tasks</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">POST http://localhost:8080/tasks?description=Some%20Task</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">POST http://localhost:8080/tasks/toggle-completion/69676cbb-430c-4be8-a3f2-f15cf9e976c3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Außerdem wollen wir natürlich auch mit fehlerhaften Benutzereingaben (wie etwa leerer <code>description</code> oder unbekannter
<code>id</code>) umgehen können und werden dazu eine sogenannte Antikorruptionsschicht zwischen unsere Kernlogik und den
REST-Adapter schalten. In einem ersten Schritt wollen wir uns aber erst einmal wieder mit Datenmodellen befassen.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Ihr findet den aktuellen Stand des Projekts sowie die Änderungen auch aus diesem Teil
auf <a href="https://github.com/ricardo-schnur/blog-post-hexagonal-architecture/tree/post3" target="_blank" rel="noopener noreferrer">GitHub</a>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tasks-mittels-eines-dedizierten-modells-serialisierbar-machen">Tasks mittels eines dedizierten Modells serialisierbar machen<a href="#tasks-mittels-eines-dedizierten-modells-serialisierbar-machen" class="hash-link" aria-label="Direkter Link zur Tasks mittels eines dedizierten Modells serialisierbar machen" title="Direkter Link zur Tasks mittels eines dedizierten Modells serialisierbar machen">​</a></h2>
<p>Als wir unser Domänenobjekt <code>Task</code> modelliert haben, haben wir uns bewusst <em>nicht</em> mit technischen Belangen
auseinandergesetzt, sondern uns komplett auf die Fachlichkeit fokussiert. Entsprechend ungeeignet ist dieses Modell
daher als Austauschformat. Das ist aber nicht weiter problematisch: Wir definieren uns nun ein
dediziertes Transfermodell <code>TaskDto</code>, das möglichst schlank und einfach (de-)serialisierbar sein soll, und
konvertieren dann nach Bedarf zwischen <code>Task</code> und <code>TaskDto</code> hin und her.</p>
<p>Dieses Transfermodell ist ein technisches
Detail unserer REST-Schnittstelle und wird daher auch Teil unseres <strong>REST-Adapters</strong>, den wir in diesem Abschnitt
anlegen.
Da nach unseren Architekturregeln keine andere Schicht und auch kein anderer Adapter auf diesen REST-Adapter
zugreifen darf, ist hierdurch sichergestellt, dass wir das Transfermodell <code>TaskDto</code> einzig lokal in diesem
Adapter verwenden und es sich nicht durch den Rest unserer Codebasis verbreiten wird.</p>
<p>Die Implementierung ist denkbar einfach gehalten:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">de</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">colenet</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">hexagonal</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">todo</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">list</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">adapter</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">rest</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">model</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">record</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">TaskDto</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> id</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> description</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> state</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> completionTime</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Statt eines Summentyps verwenden wir jetzt einen Produkttyp mit dem zusätzlichen Feld <code>state</code> als Diskriminator.
Außerdem verwenden wir simple, serialisierbare Typen für alle Eigenschaften. Hierdurch gehen uns natürlich einige
Garantien verloren, dafür erhalten wir eine flache, serialisierbare Struktur.</p>
<p>Um mit dem neu erzeugten Modell <code>TaskDto</code> arbeiten zu können, brauchen wir noch eine Möglichkeit einen <code>Task</code>
in ein <code>TaskDto</code> umzuwandeln. Dazu bauen wir uns einen Mapper mit einer entsprechenden Methode
<code>TaskDto toDto(Task model)</code>. In dieser werden wir wieder <em>Pattern Matching</em> verwenden mit der Konvention, unbenutzte
Parameter mit einem Unterstrich zu kennzeichnen:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">de</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">colenet</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">hexagonal</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">todo</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">list</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">adapter</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">rest</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">mapper</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"> </span><span class="token comment" style="color:#999999">// Omitted for clarity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token annotation punctuation" style="color:#8dc891">@Component</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">RestApiMapper</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">TaskDto</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">toDto</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">Task</span><span class="token plain"> model</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">new</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">TaskDto</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            model</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">id</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">toString</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            model</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">description</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token keyword" style="color:#c5a5c5">case</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">OpenTask</span><span class="token plain"> __ </span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;open&quot;</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token keyword" style="color:#c5a5c5">case</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">CompletedTask</span><span class="token plain"> __ </span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;completed&quot;</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token keyword" style="color:#c5a5c5">case</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">OpenTask</span><span class="token plain"> __ </span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">null</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token keyword" style="color:#c5a5c5">case</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">CompletedTask</span><span class="token plain"> t </span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token plain"> t</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">completionTime</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">toString</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="anlegen-eines-rest-controllers">Anlegen eines REST-Controllers<a href="#anlegen-eines-rest-controllers" class="hash-link" aria-label="Direkter Link zur Anlegen eines REST-Controllers" title="Direkter Link zur Anlegen eines REST-Controllers">​</a></h2>
<p>Nachdem wir uns über die Datenstrukturen im Klaren sind, können wir jetzt zur Implementierung der Endpunkte übergehen.
Dazu starten wir mit einem Controller, der Zugriff auf unseren Service sowie auf den neu angelegten Mapper haben wird:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">de</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">colenet</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">hexagonal</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">todo</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">list</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">adapter</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">rest</span><span class="token namespace punctuation" style="opacity:0.7;color:#8dc891">.</span><span class="token namespace" style="opacity:0.7">controller</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"> </span><span class="token comment" style="color:#999999">// Omitted for clarity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token annotation punctuation" style="color:#8dc891">@RestController</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">RestApiController</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">final</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">RestApiMapper</span><span class="token plain"> restApiMapper</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">final</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">TaskService</span><span class="token plain"> taskService</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token class-name" style="color:#FAC863">RestApiController</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">RestApiMapper</span><span class="token plain"> restApiMapper</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">TaskService</span><span class="token plain"> taskService</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">this</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">restApiMapper </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> restApiMapper</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">this</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">taskService </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> taskService</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Wir wollen uns in einem ersten Schritt um den <strong><code>GET</code>-Endpunkt</strong> kümmern, der alle existierenden Tasks zurückliefern
soll.
Dazu rufen wir die entsprechende Methode in unserem Service auf, wandeln die Resultate mittels unseres Mappers in
Dtos um und verpacken das Ergebnis schließlich in einer <code>ResponseEntity</code>. Die Methode annotieren wir schließlich
noch mit <code>@GetMapping</code>, alles Weitere erledigt Spring dann automatisch im Hintergrund.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token annotation punctuation" style="color:#8dc891">@GetMapping</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">value </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;/tasks&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> produces </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">MediaType</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token constant" style="color:#5a9bcf">APPLICATION_JSON_VALUE</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token class-name" style="color:#FAC863">ResponseEntity</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics class-name" style="color:#FAC863">List</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics class-name" style="color:#FAC863">TaskDto</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">getAllTasks</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">createOkResponse</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">taskService</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">getAllTasks</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">stream</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">map</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">restApiMapper</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">toDto</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">toList</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">static</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics class-name" style="color:#FAC863">T</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">ResponseEntity</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics class-name" style="color:#FAC863">T</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">createOkResponse</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">T</span><span class="token plain"> value</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">new</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">ResponseEntity</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">HttpStatus</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token constant" style="color:#5a9bcf">OK</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Für den <strong>Endpunkt zum Anlegen eines neuen Tasks</strong> gehen wir völlig analog vor, nur dass wir hier noch einen Parameter
zu
berücksichtigen haben:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token annotation punctuation" style="color:#8dc891">@PostMapping</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">value </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;/tasks&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> produces </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">MediaType</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token constant" style="color:#5a9bcf">APPLICATION_JSON_VALUE</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token class-name" style="color:#FAC863">ResponseEntity</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics operator" style="color:#d7deea">?</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">createTask</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token annotation punctuation" style="color:#8dc891">@RequestParam</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> description</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">createOkResponse</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">restApiMapper</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">toDto</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">taskService</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">createTask</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">description</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Schließlich fehlt uns noch der <strong>Endpunkt zum Umschalten des Zustands eines existierenden Tasks.</strong> Auch hier verfolgen
wir wieder das Schema, die entsprechende Logik im Service aufzurufen und das Resultat umzuwandeln, müssen jedoch
auch beachten, dass wir diesmal erst unseren <code>id</code> Parameter von <code>String</code> zu <code>UUID</code> konvertieren müssen und wir
außerdem mit der Situation, dass es keinen Task mit der angegebenen ID gibt, umgehen können müssen. In diesem Fall
werden wir schlicht mit dem Status <code>400 Bad Request</code> antworten.</p>
<p>Damit gestaltet sich die Methode folgendermaßen:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token annotation punctuation" style="color:#8dc891">@PostMapping</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">value </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;/tasks/toggle-completion/{id}&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> produces </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">MediaType</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token constant" style="color:#5a9bcf">APPLICATION_JSON_VALUE</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token class-name" style="color:#FAC863">ResponseEntity</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics operator" style="color:#d7deea">?</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">toggleCompletionState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token annotation punctuation" style="color:#8dc891">@PathVariable</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> taskService</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">toggleCompletionState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token constant" style="color:#5a9bcf">UUID</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">fromString</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">map</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">restApiMapper</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">toDto</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">map</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">RestApiController</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">createOkResponse</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">orElseGet</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">RestApiController</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">createBadRequestResponse</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">static</span><span class="token plain"> </span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics class-name" style="color:#FAC863">T</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">ResponseEntity</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics class-name" style="color:#FAC863">T</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">createBadRequestResponse</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">new</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">ResponseEntity</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">HttpStatus</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token constant" style="color:#5a9bcf">BAD_REQUEST</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Hiermit haben wir nun eine voll funktionsfähige Anwendung!</p>
<p>Im <a href="https://github.com/ricardo-schnur/blog-post-hexagonal-architecture/tree/post3" target="_blank" rel="noopener noreferrer">GitHub Repository</a> findet ihr
außerdem noch
<strong>Unit- und Integrationstests</strong> für unseren neuen Controller (<code>RestApiControllerTest</code>
und <code>RestApiControllerIntegrationTest</code>).</p>
<p>Zusätzlich ist es uns jetzt auch möglich, <strong>End-To-End-Tests</strong>, die einen vollständigen Anwendungskontext hochfahren,
eine
Folge von REST-Requests absetzen und von der Anwendung entsprechende Antworten erwarten, zu schreiben. Diese möchte
ich an dieser Stelle kurz demonstrieren, da sie auch demonstrieren, wie unsere Anwendung zu verwenden ist:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token annotation punctuation" style="color:#8dc891">@SpringBootTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">webEnvironment </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">SpringBootTest</span><span class="token class-name punctuation" style="color:#8dc891">.</span><span class="token class-name" style="color:#FAC863">WebEnvironment</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token constant" style="color:#5a9bcf">RANDOM_PORT</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">HexagonalToDoListApplicationEndToEndTests</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token annotation punctuation" style="color:#8dc891">@Autowired</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">TestRestTemplate</span><span class="token plain"> restTemplate</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token annotation punctuation" style="color:#8dc891">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">void</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">returnsEmptyListIfNoTasksHaveBeenCreated</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">var</span><span class="token plain"> result </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">getAllTasks</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">assertThat</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">getStatusCode</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">isEqualTo</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">HttpStatus</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token constant" style="color:#5a9bcf">OK</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">assertThat</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">getBody</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">isEmpty</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token annotation punctuation" style="color:#8dc891">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">void</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">creatingTasksIsPossibleAndCreatedTasksAreReturnedFromGetAll</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token class-name" style="color:#FAC863">List</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics class-name" style="color:#FAC863">String</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> descriptions </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">List</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">of</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Some description&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Some other description&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    descriptions</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">forEach</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">this</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">createTask</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">var</span><span class="token plain"> result </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">getAllTasks</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">assertThat</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">getStatusCode</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">isEqualTo</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">HttpStatus</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token constant" style="color:#5a9bcf">OK</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">assertThat</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">getBody</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">usingRecursiveFieldByFieldElementComparatorIgnoringFields</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;id&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">containsExactlyInAnyOrder</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    </span><span class="token keyword" style="color:#c5a5c5">new</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">TaskDto</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">null</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Some description&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;open&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">null</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    </span><span class="token keyword" style="color:#c5a5c5">new</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">TaskDto</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">null</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Some other description&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;open&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">null</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">assertThat</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">getBody</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">extracting</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">TaskDto</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">extracting</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token constant" style="color:#5a9bcf">UUID</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">fromString</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">doesNotContainNull</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token annotation punctuation" style="color:#8dc891">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">void</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">completionStateOfTasksCanBeToggledAndTogglingOnlyChangesStateAndCompletionTime</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">var</span><span class="token plain"> createdTask </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">createTask</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Some description&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">getBody</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">assertThat</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">createdTask</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">state</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">isEqualTo</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;open&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">var</span><span class="token plain"> id </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> createdTask</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">id</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">var</span><span class="token plain"> toggledTask </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">toggleTask</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">getBody</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">assertThat</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">toggledTask</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">usingRecursiveComparison</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">ignoringFields</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;state&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;completionTime&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">isEqualTo</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">createdTask</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">assertThat</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">toggledTask</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">state</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">isEqualTo</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;completed&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">assertThat</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">toggledTask</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">completionTime</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">isNotNull</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">var</span><span class="token plain"> toggledTwiceTask </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">toggleTask</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">getBody</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">assertThat</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">toggledTwiceTask</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">isEqualTo</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">createdTask</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">var</span><span class="token plain"> toggledThriceTask </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">toggleTask</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">getBody</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">assertThat</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">toggledThriceTask</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">usingRecursiveComparison</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">ignoringFields</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;completionTime&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">isEqualTo</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">toggledTask</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">assertThat</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">LocalDateTime</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">parse</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">toggledThriceTask</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">completionTime</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">isAfter</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">LocalDateTime</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">parse</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">toggledTask</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">completionTime</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">ResponseEntity</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics class-name" style="color:#FAC863">List</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics class-name" style="color:#FAC863">TaskDto</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">getAllTasks</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> restTemplate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">exchange</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;/tasks&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">HttpMethod</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token constant" style="color:#5a9bcf">GET</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">null</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">new</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">ParameterizedTypeReference</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">ResponseEntity</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics class-name" style="color:#FAC863">TaskDto</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">createTask</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> description</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> restTemplate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">postForEntity</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token class-name" style="color:#FAC863">UriComponentsBuilder</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">fromPath</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;/tasks&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">queryParam</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;description&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> description</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">build</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">toUri</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">null</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token class-name" style="color:#FAC863">TaskDto</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">ResponseEntity</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics class-name" style="color:#FAC863">TaskDto</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">toggleTask</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> restTemplate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">postForEntity</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;/tasks/toggle-completion/{id}&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">null</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">TaskDto</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Map</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">of</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;id&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Was uns jetzt noch fehlt, ist die eingangs erwähnte Antikorruptionsschicht. Diese soll verhindern, dass Tasks mit leerer
Beschreibung angelegt werden (was derzeit möglich wäre, aber unserer Fachlichkeit widerspricht) oder aber, dass der
Benutzer versucht, den <em>Toggle</em>-Endpunkt mit einem <code>id</code>-Wert aufzurufen, der keine gültige UUID darstellt (was
derzeit zu einer Exception führen würde).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="datenintegrität-durch-eine-antikorruptionsschicht">Datenintegrität durch eine Antikorruptionsschicht<a href="#datenintegrität-durch-eine-antikorruptionsschicht" class="hash-link" aria-label="Direkter Link zur Datenintegrität durch eine Antikorruptionsschicht" title="Direkter Link zur Datenintegrität durch eine Antikorruptionsschicht">​</a></h2>
<p>Der sicherlich gängigste Weg im Spring-Umfeld zur Sicherstellung der Datenintegrität an Endpunkten ist die Verwendung
von <em>Bean Validation</em>. Diese erfüllt den Zweck vollkommen und ist für Produktivprojekte auch klar zu empfehlen. Da
dieser
Mechanismus aber weitestgehend auf der Verwendung von Annotationen basiert, möchte ich hier zur besseren
Nachvollziehbarkeit stattdessen eine manuelle Implementierung vornehmen.</p>
<p>In der Theorie siedelt sich eine solche Antikorruptionsschicht zwischen Adapter und Kernlogik an und soll dafür sorgen,
dass die Kernlogik stets nur mit validen Daten aufgerufen wird. Das hat den immensen Vorteil, dass wir uns dann dort
niemals Gedanken um invalide Zustände machen müssen und daher dort auch nicht <em>defensiv</em> programmieren müssen. Eine
solche
Schicht macht daher nicht nur an der Grenze zu einem REST-Adapter Sinn, sondern überall, wo potenziell invalide
Datensätze von der Außenwelt an uns herangetragen werden (wie etwa eine Datenbank, über die wir nicht die alleinige
Kontrolle haben, Message-Queues, Lesen vom Dateisystem).</p>
<figure style="text-align:center"><img src="/assets/images/anti_corruption_layer-588d621c6a7a7ce61c6427551edfba66.png" alt="missing" height="500"><figcaption>Antikorruptionsschicht: Zwischen Adapter und Kernlogik</figcaption></figure>
<p>Praktisch wollen wir diese Validierung der Daten daher im entsprechenden Adapter unterbringen, da diese nur dort
Sinn macht. Denn in anderen Adaptern haben wir vermutlich andere Austauschformate und benötigen daher andere
Validierungen.</p>
<p>Dazu werden wir uns nun einen <code>RestApiValidator</code> unterhalb des REST-Adapter-Pakets in
<code>de.colenet.hexagonal.todo.list.adapter.rest.validator</code> anlegen. Dieser soll uns zwei Methoden - <code>validateId</code>
und <code>validateDescription</code> - anbieten, die jeweils einen unvalidierten <code>String</code> entgegennehmen und uns im Erfolgsfall
eine
validierte <code>UUID</code>, respektive einen validierten <code>String</code>, zurückliefern.</p>
<p>Hierzu verwenden wir
die <a href="https://docs.vavr.io/#_validation" target="_blank" rel="noopener noreferrer">Validation API von Vavr</a>, die es uns auf elegante Art und Weise erlaubt,
solche Validierungen inklusive der Berücksichtigung von Fehlern zu implementieren. Insbesondere erlaubt uns diese API,
mehrere
fehlgeschlagene Validierungen zu kombinieren und so dem Benutzer direkt Rückmeldung über jeglichen invaliden Input
zurückzumelden (hierbei sprechen wir von einem <em>Fail-Slow</em> Ansatz). Hierzu entschließen wir uns, da wir im nächsten
Teil der Serie unser Domänenmodell erweitern wollen und wir dann für den Endpunkt zum Anlegen eines neuen Tasks
mehrere Parameter entgegennehmen werden.
Im Gegensatz zum <em>Fail-Slow</em> Ansatz würde die - im Java-Umfeld gängige - Methode, bei fehlgeschlagener Validierung
eine Exception zu werfen, nur den ersten Validierungsfehler zurückmelden (ein sogenannter <em>Fail-Fast</em> Ansatz).</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Randbemerkung</div><div class="admonitionContent_BuS1"><p>Bei dem von uns gewählten <em>Fail-Slow</em>-Ansatz handelt es sich um eine in der funktionalen Programmierung
gängigen Technik. Das Konzept ist in diesem Kontext als <em>Validierung mittels applikativer Funktoren</em> geläufig.</p></div></div>
<p>Kommen wir nun also zur Umsetzung des Validators. Zur Validierung der <code>description</code> wollen wir nur
überprüfen, dass sie nicht leer ist, und ansonsten eine entsprechende Fehlermeldung generieren:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Validation</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics class-name" style="color:#FAC863">String</span><span class="token generics punctuation" style="color:#8dc891">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:#FAC863">String</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">validateDescription</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> description</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token operator" style="color:#d7deea">!</span><span class="token class-name" style="color:#FAC863">StringUtils</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">hasText</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">description</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Validation</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">invalid</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Description is mandatory&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Validation</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">valid</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">description</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Der Rückgabetyp <code>Validation</code> ist hierbei ein von Vavr bereitgestelltes Interface, welches als ersten Typparameter
den Typ des Fehlerobjekts und als zweiten Typparameter den Typ des Erfolgsobjekts erwartet. Für die Validierung
unserer ID wird der zweite Typparameter daher <code>UUID</code> sein und im nächsten Post werden wir auch eine Liste von
Strings als Fehlertyp sehen.</p>
<p>Die Validierung der ID folgt demselben Schema, hier müssen wir jedoch zusätzlich prüfen, dass der Eingabewert eine
valide UUID darstellt.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Validation</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics class-name" style="color:#FAC863">String</span><span class="token generics punctuation" style="color:#8dc891">,</span><span class="token generics"> UUID</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">validateId</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token operator" style="color:#d7deea">!</span><span class="token class-name" style="color:#FAC863">StringUtils</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">hasText</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Validation</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">invalid</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;ID is mandatory&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Try</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">of</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token plain"> </span><span class="token constant" style="color:#5a9bcf">UUID</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">fromString</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">toValidation</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">__ </span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Not a valid UUID: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Mittels <code>Try</code> fangen wir hier die von <code>UUID::fromString</code> im Fehlerfall geworfene Exception und wandeln sie in
ein <code>Validation</code>-Objekt mit entsprechender Fehlermeldung um.</p>
<p>Nun müssen wir diese Validierungen nur noch in unserem <code>RestApiController</code> jeweils vor dem Aufruf der Kernlogik
unterbringen. Dazu injizieren wir eine Instanz <code>restApiValidator</code> des gerade entworfenen Validators in den Controller
und erweitern unsere Methoden dort folgendermaßen:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token annotation punctuation" style="color:#8dc891">@PostMapping</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">value </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;/tasks&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> produces </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">MediaType</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token constant" style="color:#5a9bcf">APPLICATION_JSON_VALUE</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token class-name" style="color:#FAC863">ResponseEntity</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics operator" style="color:#d7deea">?</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">createTask</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token annotation punctuation" style="color:#8dc891">@RequestParam</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> description</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> restApiValidator</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">validateDescription</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">description</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">map</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">taskService</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">createTask</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">map</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">restApiMapper</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">toDto</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">fold</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">RestApiController</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">createBadRequestResponse</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">RestApiController</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">createOkResponse</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token annotation punctuation" style="color:#8dc891">@PostMapping</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">value </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;/tasks/toggle-completion/{id}&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> produces </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">MediaType</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token constant" style="color:#5a9bcf">APPLICATION_JSON_VALUE</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token class-name" style="color:#FAC863">ResponseEntity</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics operator" style="color:#d7deea">?</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">toggleCompletionState</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token annotation punctuation" style="color:#8dc891">@PathVariable</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> restApiValidator</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">validateId</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">map</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">taskService</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">toggleCompletionState</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">fold</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  </span><span class="token class-name" style="color:#FAC863">RestApiController</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">createBadRequestResponse</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  toggledTask </span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                          toggledTask</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                                  </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">map</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">restApiMapper</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">toDto</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                                  </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics class-name" style="color:#FAC863">ResponseEntity</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics operator" style="color:#d7deea">?</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token function" style="color:#79b6f2">map</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">RestApiController</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">createOkResponse</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                                  </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">orElseGet</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">createBadRequestResponse</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;No task found for id: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">static</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">ResponseEntity</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics class-name" style="color:#FAC863">String</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">createBadRequestResponse</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name" style="color:#FAC863">String</span><span class="token plain"> message</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">new</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">ResponseEntity</span><span class="token generics punctuation" style="color:#8dc891">&lt;</span><span class="token generics punctuation" style="color:#8dc891">&gt;</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">HttpStatus</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token constant" style="color:#5a9bcf">BAD_REQUEST</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Natürlich haben wir im Repository auch Unittests für den Validator mit aufgenommen und unsere bestehenden Tests
erweitert.</p>
<p><strong>Damit ist der erste Wurf unserer Anwendung komplett.</strong></p>
<p>Probiert sie doch gerne mal aus: Legt Tasks an, lasst euch diese anzeigen, vervollständigt sie und setzt auch mal
absichtlich Requests mit invaliden Daten ab, wie etwa:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">POST http://localhost:8080/tasks?description=%20</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">POST http://localhost:8080/tasks/toggle-completion/not-a-valid-uuid</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ausblick">Ausblick<a href="#ausblick" class="hash-link" aria-label="Direkter Link zur Ausblick" title="Direkter Link zur Ausblick">​</a></h2>
<p>Im kommenden Teil wollen wir uns anschauen, wie sich eine Anpassung am Domänenmodell auf die Anwendung auswirkt. Dazu
werden wir unseren Tasks ein Fälligkeitsdatum hinzufügen. Dieses werden wir dann auch nutzen, um die bisher noch
unberührte Applikationsschicht mit Leben zu füllen, indem wir uns einen geplanten Auftrag anlegen, der uns regelmäßig
über fällige Tasks benachrichtigt. Außerdem wollen wir die Möglichkeit bieten, beim Anwendungsstart automatisch einige
Beispieltasks zu erzeugen.</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/domain-driven-design">Domain-driven Design</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/hexagonale-architektur">Hexagonale Architektur</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/softwarearchitektur">Softwarearchitektur</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/softwareentwicklung">Softwareentwicklung</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog Post Seiten Navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/hexagonal-architecture-java-spring-boot-part-4"><div class="pagination-nav__sublabel">Neuer Post</div><div class="pagination-nav__label">Hexagonale Architektur in der Praxis: Umsetzung in einem Java/Spring Boot Projekt – Teil 4: Folgen einer Änderung am Domänenmodell und die Applikationsschicht</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/hexagonal-architecture-java-spring-boot-part-2"><div class="pagination-nav__sublabel">Älterer Post</div><div class="pagination-nav__label">Hexagonale Architektur in der Praxis: Umsetzung in einem Java/Spring-Boot-Projekt – Teil 2: Modellierung, Kernlogik und In-Memory Cache</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tasks-mittels-eines-dedizierten-modells-serialisierbar-machen" class="table-of-contents__link toc-highlight">Tasks mittels eines dedizierten Modells serialisierbar machen</a></li><li><a href="#anlegen-eines-rest-controllers" class="table-of-contents__link toc-highlight">Anlegen eines REST-Controllers</a></li><li><a href="#datenintegrität-durch-eine-antikorruptionsschicht" class="table-of-contents__link toc-highlight">Datenintegrität durch eine Antikorruptionsschicht</a></li><li><a href="#ausblick" class="table-of-contents__link toc-highlight">Ausblick</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Ricardo Schnur</div></div></div></footer></div>
</body>
</html>